<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LuxAxion | çµ¦ä½ çš„å›°æƒ‘èˆ‡å•é¡Œï¼Œä¸€å€‹ç²¾æº–çš„æ–¹å‘èˆ‡ä¸‹ä¸€æ­¥</title>
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://luxaxion.netlify.app/">
    <meta property="og:title" content="LuxAxion | çµ¦ä½ çš„å›°æƒ‘èˆ‡å•é¡Œï¼Œä¸€å€‹ç²¾æº–çš„æ–¹å‘èˆ‡ä¸‹ä¸€æ­¥">
    <meta property="og:description" content="çµåˆæ˜“ç¶“ã€å¡å·´æ‹‰èˆ‡ç…‰é‡‘è¡“çš„ç²¾æº–å°ä½ï¼Œç‚ºä½ çš„ç¾ç‹€æ‰¾åˆ°æ¸…æ™°å‡ºå£ã€‚">
    <meta property="og:image" content="https://luxaxion.netlify.app/og-image.png">
    
    <style>
        :root { --gold: #C5A059; --midnight: #1A2233; --white: #F5F5F5; --accent: #D4AF37; }
        body { background: #141E30; color: var(--white); font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; overflow-x: hidden; }
        .container { width: 90%; max-width: 420px; padding: 25px; text-align: center; }
        .logo { color: var(--gold); font-size: 1.8rem; letter-spacing: 8px; margin-bottom: 30px; font-weight: bold; }
        .step { display: none; }
        .step.active { display: block; animation: fadeIn 0.8s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        textarea { width: 100%; background: rgba(255,255,255,0.05); border: 1px solid rgba(197, 160, 89, 0.3); border-radius: 15px; color: #fff; padding: 15px; font-size: 1rem; outline: none; margin-top: 20px; box-sizing: border-box; }
        .instruction-list { text-align: center; font-size: 0.9rem; line-height: 1.8; color: var(--white); opacity: 0.9; margin: 20px 0; list-style: none; padding: 0; }

        /* æµ®çª—æ¨£å¼ */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; z-index: 1000; backdrop-filter: blur(5px); }
        .modal-content { width: 85%; max-width: 350px; background: #1A2233; border: 1px solid var(--gold); border-radius: 20px; padding: 25px; text-align: left; position: relative; animation: modalIn 0.4s ease forwards; }
        @keyframes modalIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .modal-title { color: var(--gold); font-weight: bold; margin-bottom: 15px; font-size: 1.1rem; text-align: center; }
        .modal-body { font-size: 0.9rem; line-height: 1.6; color: #ddd; }
        .modal-body b { color: var(--gold); }
        .close-modal { margin-top: 20px; background: transparent; border: 1px solid var(--gold); color: var(--gold); width: 100%; padding: 10px; border-radius: 30px; cursor: pointer; }

        .help-link { color: var(--gold); font-size: 0.85rem; text-decoration: underline; cursor: pointer; margin-top: 10px; display: inline-block; opacity: 0.8; padding: 0 5px; }
        .help-link:hover { opacity: 1; }

        #coin-lab { height: 120px; display: flex; justify-content: center; align-items: center; margin: 20px 0; perspective: 1000px; }
        .coin-slot { width: 50px; height: 50px; margin: 0 10px; border: 1px solid rgba(197, 160, 89, 0.2); border-radius: 50%; }
        .coin { width: 48px; height: 48px; background: radial-gradient(circle, #F5D76E, var(--gold)); border-radius: 50%; opacity: 0; display: flex; align-items: center; justify-content: center; font-size: 9px; color: #403010; font-weight: bold; transform: translateY(30px); transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        .sephiroth-map { position: relative; height: 400px; margin: 30px auto; width: 300px; }
        .node { position: absolute; width: 55px; height: 55px; border-radius: 50%; border: 1px solid rgba(197, 160, 89, 0.4); display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; background: rgba(26, 34, 51, 0.9); z-index: 10; font-size: 1.5rem; color: var(--gold); }
        .node:hover { transform: scale(1.1); box-shadow: 0 0 20px var(--gold); border-color: #fff; }
        .node.selected { border-color: #fff; box-shadow: 0 0 25px var(--gold); background: var(--gold); color: #000; }

        .fluid-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 25px; }
        .fluid-box { height: 85px; border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: bold; position: relative; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }
        .fluid-box span { position: relative; z-index: 2; }
        .fluid-box::after { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; animation: flow 8s linear infinite; opacity: 0.6; z-index: 1; }
        @keyframes flow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .black::after { background: conic-gradient(#000, #200020, #000); }
        .white::after { background: conic-gradient(#fff, #e0e0ff, #fff); }
        .white span { color: #000; }
        .yellow::after { background: conic-gradient(#FFD700, #FFA500, #FFD700); }
        .yellow span { color: #000; }
        .red::after { background: conic-gradient(#8B0000, #FF0000, #8B0000); }

        .result-card { background: #E9ECEF; color: #212529; padding: 25px; border-radius: 20px; text-align: left; box-shadow: 0 15px 35px rgba(0,0,0,0.4); }
        .gua-box { display: flex; justify-content: space-around; background: rgba(0,0,0,0.05); padding: 15px; border-radius: 12px; margin: 15px 0; }
        .line { font-family: monospace; font-size: 1.4rem; font-weight: bold; line-height: 1.2; letter-spacing: -1px; }
        .line.active { color: #D63031; }

        .main-btn { background: var(--gold); color: #141E30; border: none; padding: 18px; border-radius: 40px; font-weight: bold; cursor: pointer; width: 100%; font-size: 1rem; margin-top: 20px; transition: 0.3s; }
        .main-btn:active { transform: scale(0.98); opacity: 0.9; }
        .copy-btn { width: 100%; background: #f8f9fa; border: 1px solid #ddd; padding: 10px; border-radius: 8px; margin-top: 15px; cursor: pointer; font-size: 0.85rem; color: #333; transition: 0.3s; }
        .copy-btn:hover { background: #eee; }
        /* Instagram å¼•å°å€å¡Šå®¹å™¨ */
        .ig-redirect-box {
            margin-top: 25px;
            padding: 15px;
            background: rgba(197, 160, 89, 0.08); /* æ·¡æ·¡çš„é‡‘å±¬é€æ˜æ„Ÿ */
            border: 1px solid rgba(197, 160, 89, 0.3);
            border-radius: 12px;
            text-align: center;
        }

        .ig-text {
            font-size: 0.9rem;
            color: var(--black);
            margin-bottom: 10px;
            line-height: 1.5;
            opacity: 0.9;
        }

        /* å¼·åŒ– Instagram é€£çµæŒ‰éˆ•æ„Ÿ */
        .ig-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: var(--gold) !important;
            text-decoration: none;
            font-weight: bold;
            font-size: 1rem;
            padding: 8px 16px;
            border: 1.5px solid var(--gold);
            border-radius: 30px;
            transition: all 0.3s ease;
        }

        .ig-link:hover {
            background: var(--gold);
            color: #141E30 !important;
            box-shadow: 0 0 15px rgba(197, 160, 89, 0.4);
        }

        /* åŠ å…¥åœ–æ¨™æç¤ºï¼ˆå¯é¸ï¼‰ */
        .ig-link::before {
            content: 'ğŸ“¸ ';
            margin-right: 5px;
        }
    </style>
</head>
<body>

<div id="helpModal" class="modal-overlay" onclick="toggleModal('helpModal', false)">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-title">å¦‚ä½•æ›´ç²¾æº–åœ°æå•ï¼Ÿ</div>
        <div class="modal-body">
            1. <b>å…·é«”åŒ–å•é¡Œï¼š</b>é¿å…å•ã€Œæˆ‘çš„æœªä¾†å¦‚ä½•ï¼Ÿã€ï¼Œè©¦è‘—å•ã€Œé€™å…©å€‹æœˆå…§æ›å·¥ä½œå°æˆ‘çš„ç™¼å±•æ˜¯å¦æœ‰ç›Šï¼Ÿã€<br><br>
            2. <b>å°ˆæ³¨ç•¶ä¸‹ï¼š</b>æ½›æ„è­˜å°èˆªé©åˆè§£æ±ºç›®å‰çš„å¡é»èˆ‡æŠ‰æ“‡ã€‚<br><br>
            3. <b>æ˜¯é/é¸æ“‡ï¼š</b>å•é¡Œå¯ä»¥åŒ…å«æ˜ç¢ºçš„å‹•ä½œï¼Œä¾‹å¦‚ã€Œæˆ‘æ˜¯å¦è©²å•Ÿå‹•æ–°çš„æŠ•è³‡è¨ˆç•«ï¼Ÿã€<br><br>
            4. <b>ä¿æŒå¹³éœï¼š</b>è¼¸å…¥å®Œå¾Œï¼Œè«‹å‹™å¿…æŒ‰ç…§ç•«é¢çš„æŒ‡ä»¤é»˜å¿µï¼Œé€™èƒ½å”åŠ©æ‚¨çš„èƒ½é‡å°ä½ã€‚
        </div>
        <button class="close-modal" onclick="toggleModal('helpModal', false)">æˆ‘æ˜ç™½äº†</button>
    </div>
</div>

<div id="introModal" class="modal-overlay" onclick="toggleModal('introModal', false)">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-title">å•Ÿå‹•å‰å¿…çœ‹</div>
        <div class="modal-body">
            æ­¡è¿ä¾†åˆ° <b>LuxAxion.Lab</b>ã€‚<br><br>
            é€™æ˜¯ä¸€å€‹çµåˆ<b>æ˜“ç¶“ã€å¡å·´æ‹‰ã€ç…‰é‡‘è¡“</b>çš„å®šä½ç³»çµ±ã€‚åœ¨é–‹å§‹ä¹‹å‰ï¼Œè«‹çµ¦è‡ªå·±ä¸€å€‹å®‰éœçš„ç©ºé–“ã€‚<br><br>
            æœ¬ç³»çµ±ä¸æä¾›é€šéˆé æ¸¬ï¼Œè€Œæ˜¯é€éæ‚¨çš„æ½›æ„è­˜åæ‡‰ï¼Œæ˜ å°„å‡º<b>ç¾ç‹€çš„å±€å‹¢</b>èˆ‡<b>å»ºè­°çš„ä¸‹ä¸€æ­¥</b>ã€‚è«‹èª å¯¦åœ°é¢å°æ‚¨çš„ç›´è¦ºï¼Œå°ä½æ‰æœƒç²¾æº–ã€‚
        </div>
        <button class="close-modal" onclick="toggleModal('introModal', false)">é–‹å§‹å°ä½</button>
    </div>
</div>

<div class="container">
    <div class="logo">LuxAxion.Lab</div>

    <div id="s0" class="step active">
        <div style="color:var(--gold); font-size:1.1rem; font-weight:bold;">çµ¦ä½ çš„å›°æƒ‘èˆ‡å•é¡Œï¼Œ<br>æ‰¾å›ç²¾æº–çš„æ–¹å‘èˆ‡ä¸‹ä¸€æ­¥ã€‚</div>
        <ul class="instruction-list">
            <li>è¼¸å…¥å•é¡Œå¾Œï¼Œè«‹é»˜å¿µä»¥ä¸‹ï¼š</li>
            <li>è‡ªå·±çš„åå­—ä¸‰æ¬¡ | å‡ºç”Ÿå¹´æœˆæ—¥ | è©¢å•çš„å•é¡Œ</li>
            <li>æœ€å¾Œé»˜å¿µï¼šã€Œè«‹æˆ‘çš„æ½›æ„è­˜çµ¦æˆ‘ä¸€å€‹æŒ‡ç¤ºã€</li>
        </ul>
        <textarea id="ui-q" placeholder="åœ¨æ­¤è¼¸å…¥ä½ çš„å›°æƒ‘æˆ–å•é¡Œ..."></textarea>
        
        <div>
            <span class="help-link" onclick="toggleModal('introModal', true)">ğŸ“œ å•Ÿå‹•å‰å¿…çœ‹</span>
            <span class="help-link" onclick="toggleModal('helpModal', true)">ğŸ’¡ å¦‚ä½•å•å•é¡Œï¼Ÿ</span>
        </div>
        
        <button class="main-btn" onclick="toStep(1)">é–‹å§‹ç²¾æº–å®šä½</button>
    </div>

    <div id="s1" class="step">
        <h3 style="color:var(--gold);">ä¾†æ“²ç¡¬å¹£å§</h3>
        <p style="opacity:0.8; font-size:0.9rem;">èª å¿ƒåœ°æŒ‰ä¸‹æ¯ä¸€æ¬¡çš„æŒ‰éˆ•ï¼Œä¸€å…±å…­æ¬¡</p>
        <div id="coin-lab">
            <div class="coin-slot"><div id="c1" class="coin">LIGHT</div></div>
            <div class="coin-slot"><div id="c2" class="coin">LIGHT</div></div>
            <div class="coin-slot"><div id="c3" class="coin">LIGHT</div></div>
        </div>
        <div id="coin-log" style="font-size:0.8rem; color:var(--gold); min-height:80px; margin-bottom:15px;"></div>
        <button id="btn-toss" class="main-btn" onclick="doToss()">æ“²å¹£å°é½Š</button>
    </div>

    <div id="s2" class="step">
        <h3 style="color:var(--gold);">çœ‹è‘—é€™äº›ç¬¦è™Ÿï¼Œå“ªä¸€å€‹å°ä½ ä¾†èªªæœ€ã€Œæœ‰æ„Ÿè¦ºã€ï¼Ÿ</h3>
        <div class="sephiroth-map">
            <div class="node" style="top:0%; left:40%; border-color:#FFFFFF;" onclick="selK('Kether')">K</div>
            <div class="node" style="top:15%; right:10%; border-color:#888;" onclick="selK('Chokmah')">C</div>
            <div class="node" style="top:15%; left:10%; border-color:#666;" onclick="selK('Binah')">B</div>
            <div class="node" style="top:40%; right:10%; border-color:#3498DB;" onclick="selK('Chesed')">â™ƒ</div>
            <div class="node" style="top:40%; left:10%; border-color:#E74C3C;" onclick="selK('Geburah')">â™‚</div>
            <div class="node" style="top:50%; left:40%; border-color:var(--gold);" onclick="selK('Tiphareth')">â˜‰</div>
            <div class="node" style="top:70%; right:10%; border-color:#33CC33;" onclick="selK('Netzach')">â™€</div>
            <div class="node" style="top:70%; left:10%; border-color:#FF9933;" onclick="selK('Hod')">â˜¿</div>
            <div class="node" style="top:85%; left:40%; border-color:#CC33FF;" onclick="selK('Yesod')">â˜½</div>
            <div class="node" style="top:100%; left:40%; border-color:#996633;" onclick="selK('Malkuth')">âŠ•</div>
        </div>
    </div>

    <div id="s3" class="step">
        <h3 style="color:var(--gold);">æœ€å¾Œä¸€æ­¥ï¼Œé€™å››ç¨®å…‰è­œä¸­ï¼Œå“ªä¸€å€‹æœ€å¸å¼•ç¾åœ¨çš„ä½ ï¼Ÿ</h3>
        <div class="fluid-grid">
            <div class="fluid-box black" onclick="selA('é»‘åŒ–','#0A000A')"><span>é»‘åŒ–</span></div>
            <div class="fluid-box white" onclick="selA('ç™½åŒ–','#F5F5F5')"><span>ç™½åŒ–</span></div>
            <div class="fluid-box yellow" onclick="selA('é»ƒåŒ–','#1A1500')"><span>é»ƒåŒ–</span></div>
            <div class="fluid-box red" onclick="selA('ç´…åŒ–','#1A0000')"><span>ç´…åŒ–</span></div>
        </div>
    </div>

    <div id="s4" class="step">
        <div class="result-card">
            <div id="rf-q" style="font-weight:bold; border-bottom:1px solid #ccc; padding-bottom:10px; margin-bottom:15px;"></div>
            <div class="gua-box">
                <div style="text-align:center;"><div id="g1-title" style="font-size:0.8rem; font-weight:bold; color:var(--gold); margin-bottom:5px;">æœ¬å¦</div><div id="g1"></div></div>
                <div style="text-align:center;"><div id="g2-title" style="font-size:0.8rem; font-weight:bold; color:var(--gold); margin-bottom:5px;">è®Šå¦</div><div id="g2"></div></div>
            </div>
            <div id="ai-guidance" style="margin-bottom: 15px; padding: 12px; background: #fff; color: #141E30; border-radius: 12px; font-weight: bold; font-size: 0.95rem; border-left: 5px solid var(--gold); display: none;">
                <span id="ai-loading">ğŸ”® å°èˆªå°ä½ä¸­...</span>
                <span id="ai-text"></span>
            </div>
            <div style="font-size:0.9rem; line-height:1.8;">
                <div id="rf-k"></div>
                <div id="rf-a"></div>
            </div>
            <button class="copy-btn" onclick="copyData()">ğŸ“‹ é»é¸æŒ‰éˆ•è¤‡è£½å°èˆªæ•¸æ“š</button>
            <div class="ig-redirect-box">
                <div class="ig-text">
                    å°‡å°èˆªæ•¸æ“šå‚³çµ¦ LuxAxion<br/>ç²å–æ›´è©³ç›¡çš„å€‹äººåŒ–å°ä½è³‡è¨Šã€‚
                </div>
                <a href="https://www.instagram.com/LuxAxion.Lab" target="_blank" class="ig-link">
                    Instagram @LuxAxion.Lab
                </a>
            </div>
            <div id="copy-status" style="font-size:0.7rem; color:green; margin-top:5px; display:none; text-align:center;">å·²æˆåŠŸè¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼</div>
        </div>
        <button class="main-btn" style="background:#333; color:#fff;" onclick="location.reload()">é‡æ–°æ ¡æº–</button>
    </div>
</div>

<script>
    const GUA_LIST = {"111111":"ä¹¾ç‚ºå¤©","000000":"å¤ç‚ºåœ°","100010":"æ°´é›·å±¯","010001":"å±±æ°´è’™","111010":"æ°´å¤©éœ€","010111":"å¤©æ°´è¨Ÿ","010000":"åœ°æ°´å¸«","000010":"æ°´åœ°æ¯”","111011":"é¢¨å¤©å°ç•œ","110111":"å¤©æ¾¤å±¥","111000":"åœ°å¤©æ³°","000111":"å¤©åœ°å¦","101111":"å¤©ç«åŒäºº","111101":"ç«å¤©å¤§æœ‰","001000":"åœ°å±±è¬™","000100":"é›·åœ°è±«","100110":"æ¾¤é›·éš¨","011001":"å±±é¢¨è ±","110000":"åœ°æ¾¤è‡¨","000011":"é¢¨åœ°è§€","100101":"ç«é›·å™¬å—‘","101001":"å±±ç«è³","000001":"å±±åœ°å‰","100000":"åœ°é›·å¾©","100111":"å¤©é›·ç„¡å¦„","111001":"å±±å¤©å¤§ç•œ","100001":"å±±é›·é ¤","011110":"æ¾¤é¢¨å¤§é","010010":"åç‚ºæ°´","101101":"é›¢ç‚ºç«","001110":"æ¾¤å±±å’¸","011100":"é›·é¢¨æ†","001111":"å¤©å±±é¯","111100":"é›·å¤©å¤§å£¯","000101":"ç«åœ°æ™‰","101000":"åœ°ç«æ˜å¤·","101011":"é¢¨ç«å®¶äºº","110101":"ç«æ¾¤ç½","001010":"æ°´å±±è¹‡","010100":"é›·æ°´è§£","110001":"å±±æ¾¤æ","100011":"é¢¨é›·ç›Š","111110":"æ¾¤å¤©å¤¬","011111":"å¤©é¢¨å§¤","000110":"æ¾¤åœ°èƒ","011000":"åœ°é¢¨å‡","010110":"æ¾¤æ°´å›°","011010":"æ°´é¢¨äº•","101110":"æ¾¤ç«é©","011101":"ç«é¢¨é¼","100100":"éœ‡ç‚ºé›·","001001":"è‰®ç‚ºå±±","001011":"é¢¨å±±æ¼¸","110100":"é›·æ¾¤æ­¸å¦¹","101100":"é›·ç«è±","001101":"ç«å±±æ—…","011011":"å·½ç‚ºé¢¨","110110":"å…Œç‚ºæ¾¤","010011":"é¢¨æ°´æ¸™","110010":"æ°´æ¾¤ç¯€","110011":"é¢¨æ¾¤ä¸­å­š","001100":"é›·å±±å°é","101010":"æ°´ç«æ—¢æ¿Ÿ","010101":"ç«æ°´æœªæ¿Ÿ"};

    let q="", coins=[], kab="", alch="", isAn=false;

    function toggleModal(id, show) {
        document.getElementById(id).style.display = show ? 'flex' : 'none';
    }

    function toStep(n) {
        if(n===1 && !document.getElementById('ui-q').value) return alert("è«‹è¼¸å…¥å•é¡Œ");
        q = document.getElementById('ui-q').value;
        document.querySelectorAll('.step').forEach(s=>s.classList.remove('active'));
        document.getElementById('s'+n).classList.add('active');
    }

    function doToss() {
        if(isAn || coins.length>=6) return;
        isAn = true;
        const cns = [document.getElementById('c1'), document.getElementById('c2'), document.getElementById('c3')];
        cns.forEach(c => { c.style.opacity = '0'; c.style.transform = 'translateY(30px)'; });

        setTimeout(() => {
            cns.forEach(c => { c.style.opacity = '1'; c.style.transform = `translateY(0) rotateY(${720+Math.random()*360}deg)`; });
            let s = (Math.random()>0.5?3:2)+(Math.random()>0.5?3:2)+(Math.random()>0.5?3:2);
            coins.push(s);
            let m = {6:"âœ• è€é™°", 7:"â€” å°‘é™½", 8:"- - å°‘é™°", 9:"â—¯ è€é™½"};
            let currentLine = coins.length;
            const logEntry = document.createElement('div');
            logEntry.style.marginBottom = "4px";
            logEntry.innerHTML = `<span style="color:rgba(255,255,255,0.5)">ç¬¬ ${currentLine} çˆ»ï¼š</span> [${m[s]}]`;
            const logContainer = document.getElementById('coin-log');
            logContainer.insertBefore(logEntry, logContainer.firstChild);
            isAn = false;
            if(coins.length===6) {
                document.getElementById('btn-toss').innerText = "å°é½Šå®Œæˆ";
                setTimeout(() => toStep(2), 1000);
            }
        }, 50);
    }
    
    function selK(v) { kab=v; toStep(3); }
    function selA(v, color) { 
        alch=v; document.body.style.background = color;
        setTimeout(() => {
            toStep(4);
            document.getElementById('rf-q').innerText = "ä½ çš„å•é¡Œæ˜¯ï¼š" + q;
            document.getElementById('rf-k').innerHTML = "ğŸ”® èƒ½é‡å…±æŒ¯ï¼š<strong>" + kab + "</strong>";
            document.getElementById('rf-a').innerHTML = "ğŸ”¥ æ³¨å…¥è‰²èª¿ï¼š<strong>" + alch + "</strong>";
            drawG('g1', false); drawG('g2', true);
            getAIGuidance(); // åœ¨é€™è£¡è§¸ç™¼ AI
        }, 600);
    }

    function getGua(cArr) {
        let b = cArr.map(n => (n === 7 || n === 9 ? "1" : "0")).join("");
        return GUA_LIST[b] || "æœªçŸ¥å¦è±¡";
    }

    function drawG(id, isC) {
        const el = document.getElementById(id);
        const targetCoins = isC ? coins.map(n => (n===6?7:(n===9?8:n))) : coins;
        const gName = getGua(targetCoins);
        document.getElementById(id+'-title').innerText = (isC?'è®Šå¦ï¼š':'æœ¬å¦ï¼š') + gName;
        el.innerHTML = "";
        [...targetCoins].reverse().forEach((n, i) => {
            let isY = (n===7 || n===9);
            let d = document.createElement('div');
            d.className = 'line' + (!isC && (coins[5-i]===6||coins[5-i]===9) ? ' active':'');
            d.innerText = isY ? "â€”â€”â€”â€”â€”â€”â€”" : "â€”â€”â€”  â€”â€”â€”";
            el.appendChild(d);
        });
    }

   async function getAIGuidance() {
        const aiBox = document.getElementById('ai-guidance');
        const aiText = document.getElementById('ai-text');
        const aiLoading = document.getElementById('ai-loading');
        
        aiBox.style.display = 'block';
        aiText.innerText = '';
        aiLoading.style.display = 'inline';

        // æ ¸å¿ƒè¨­å®š
        const part1 = "AIzaSyDIKcvgd--"; 
        const part2 = "YfolSApsJFxo1j5GuLnJuYPQ"; 
        const API_KEY = part1 + part2;
        const modelName = "gemini-flash-latest"; 
        const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${API_KEY}`;

        // 1. è¨ˆç®—è®Šçˆ»èˆ‡è§£å¦é‚è¼¯
        const changeCount = coins.filter(n => n === 6 || n === 9).length;
        const rules = {
            0: "ä»¥æœ¬å¦çš„å¦è¾­ã€å¦ç¾©è§£å¦ã€‚è¼”ä»¥å¤§è¡ä¹‹æ•¸ã€‚",
            1: "ä»¥æœ¬å¦è®Šçˆ»è¾­è§£å¦ã€‚",
            2: "ä»¥æœ¬å¦äºŒè®Šçˆ»è§£å¦ï¼ˆä¸‹çˆ»ç‚ºè²ï¼Œä¸Šçˆ»ç‚ºæ‚”ï¼‰ã€‚",
            3: "ä»¥æœ¬å¦åŠè®Šå¦å¦è¾­è§£å¦ï¼ˆæœ¬å¦ç‚ºè²ï¼Œè®Šå¦ç‚ºæ‚”ï¼‰ã€‚",
            4: "ä»¥è®Šå¦ç‚ºè²ï¼Œæœ¬å¦ç‚ºæ‚”ã€‚",
            5: "ä»¥è®Šå¦ç‚ºè²ï¼Œæœ¬å¦ç‚ºæ‚”ã€‚",
            6: "ä¹¾å¤å¦ç”¨ä¹å…­ï¼Œé¤˜å¦ä»¥è®Šå¦å¦è¾­è§£ã€‚"
        };
        const specificRule = rules[changeCount] || rules[6];

        // 2. å»ºæ§‹æ·±åº¦ Prompt
        const prompt = `
ä½ æ˜¯ä¸€ä½ LuxAxion é«˜ç´šå°å¸«ã€‚ä½ èªªè©±çš„èªæ°£æ‡‰ã€Œæº«æš–ã€å°ˆæ¥­ã€æ˜“æ‡‚ã€ï¼Œé¿å…éå¤šé›£æ‡‚çš„æ–‡è¨€æ–‡æˆ–è‰±æ·±è¡“èªï¼Œè«‹ç”¨ç¾ä»£ç™½è©±èªæ°£å°‡æ™ºæ…§è½‰åŒ–ç‚ºå…·é«”çš„æŒ‡å¼•ã€‚

ã€æ ¸å¿ƒæ•¸æ“šã€‘
å•é¡Œï¼š${q}
æœ¬å¦ï¼š${getGua(coins)}
è®Šçˆ»æ•¸ï¼š${changeCount}
è§£å¦æº–å‰‡ï¼š${rules[changeCount]||rules[6]}
å¡å·´æ‹‰ï¼š${kab}
éŠé‡‘è¡“éšæ®µï¼š${alch}

ã€å›è¦†è¦å‰‡ã€‘
1. **åƒåœ¾éæ¿¾**ï¼šè‹¥å•é¡Œç„¡æ„ç¾©ï¼ˆå¦‚ test, 123...ï¼‰ï¼Œåƒ…å›è¦†ï¼šã€ŒğŸ”® èƒ½é‡å°šæœªèšç„¦ã€‚è«‹èª å¿ƒè¼¸å…¥æ‚¨å…·é«”æƒ³æŒ‡å¼•çš„å•é¡Œï¼Œå†é€²è¡Œæ ¡æº–ã€‚ã€ä¸¦çµæŸã€‚

2. **æ·±åº¦è§£æè¦æ±‚**ï¼š
   * **å…¨éƒ¨çš„å›è¦†å­—æ•¸ç´„åœ¨300å­—å…§ï¼Œä¸è¦åœ¨å›è¦†æœ«å°¾é¡¯ç¤ºã€Œ(xxå­—)ã€ç­‰å­—æ•¸æ¨™è¨»ã€‚**
   * **é–‹é ­ä¸è¦ç”¨LuxAxion é«˜ç´šå°å¸«çš„é–‹é ­**
   * **a.ã€å¦è±¡æŒ‡å¼•ã€‘**ï¼šç”¨å¹³æ˜“è¿‘äººçš„ç™½è©±è§£é‡‹å¦è±¡å°ç›®å‰å•é¡Œçš„å½±éŸ¿ã€‚å°±åƒåœ¨èŠå¤©ä¸€æ¨£ï¼Œå‘Šè¨´å°æ–¹ç¾åœ¨çš„å±€å‹¢æ˜¯ä»€éº¼ã€è¦æ³¨æ„ä»€éº¼ã€‚
   * **b.ã€èƒ½é‡å…±æŒ¯ã€‘**ï¼šæ ¹æ“š ${kab} çµ¦äºˆç”Ÿæ´»åŒ–çš„å¿ƒéˆå»ºè­°ï¼Œè®“å°æ–¹çŸ¥é“å¯ä»¥å¦‚ä½•èª¿æ•´å¿ƒæ…‹ã€‚
   * **c.ã€éŠé‡‘è½‰åŒ–ã€‘**ï¼šè§£é‡‹ ${alch} éšæ®µä»£è¡¨çš„æ„ç¾©ï¼Œä¸¦çµ¦å‡ºä¸€å€‹å…·é«”èƒ½åŸ·è¡Œçš„ã€Œä¸‹ä¸€æ­¥ã€ã€‚

3. **çµå°¾è¡Œå‹•**ï¼ˆå›ºå®šçµèªï¼‰ï¼š
ã€Œâœ¨ æ›´è©³ç›¡çš„è§£è®€è«‹æˆªåœ–æˆ–è¤‡è£½ä¸‹æ–¹å…§å®¹çµ¦ LuxAxion Labï¼ˆInstagram @LuxAxion.Lab)ã€‚
ğŸ’ å¦‚éœ€èƒ½é‡æ‰‹éŠè¨‚è£½æˆ–å•é¡Œå¼•å°æ•™ç·´ï¼Œè«‹æ´½ LuxAxion Labï¼ˆInstagram @LuxAxion.Lab)ã€‚ã€`;

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: prompt }] }]
                })
            });

            const data = await response.json();
            
            if (data.error) {
                console.error("å°ä½å¤±æ•—:", data.error);
                aiLoading.innerText = `ğŸ”® æ™ºåº«å°ä½ä¸­ (Error: ${data.error.message})`;
                return;
            }

            const aiResult = data.candidates[0].content.parts[0].text;
            aiLoading.style.display = 'none';
            // ä½¿ç”¨ innerHTML ç¢ºä¿æ›è¡Œèˆ‡åŠ ç²—èƒ½é¡¯ç¤ºï¼ˆè‹¥ AI å›å‚³ Markdown æ ¼å¼ï¼‰
            aiText.innerHTML = aiResult.replace(/\n/g, '<br>');
        } catch (error) {
            aiLoading.innerText = "ğŸ”® èƒ½é‡å‚³è¼¸ä¸­ï¼Œè«‹ç¨å€™ã€‚";
        }
    }
    function copyData() {
        let changeCount = coins.filter(n => n === 6 || n === 9).length;
        let sum = coins.reduce((a, b) => a + b, 0);
        let diff = 55 - sum;
        let dayanPos = "";
        let cyclePos = diff % 12; 
        if (cyclePos === 0) cyclePos = 12; 
        if (cyclePos <= 6) { dayanPos = `ç¬¬ ${cyclePos} çˆ» (å‘ä¸Š)`; } 
        else { dayanPos = `ç¬¬ ${13 - cyclePos} çˆ» (å‘ä¸‹)`; }

        const rules = {
            0: "ä»¥æœ¬å¦çš„å¦è¾­ã€å¦ç¾©è§£å¦ã€‚è¼”ä»¥å¤§è¡ä¹‹æ•¸ã€‚",
            1: "ä»¥æœ¬å¦è®Šçˆ»è¾­è§£å¦ã€‚",
            2: "ä»¥æœ¬å¦äºŒè®Šçˆ»è§£å¦ï¼ˆä¸‹çˆ»ç‚ºè²ï¼Œä¸Šçˆ»ç‚ºæ‚”ï¼‰ã€‚",
            3: "ä»¥æœ¬å¦åŠè®Šå¦å¦è¾­è§£å¦ï¼ˆæœ¬å¦ç‚ºè²ï¼Œè®Šå¦ç‚ºæ‚”ï¼‰ã€‚",
            4: "ä»¥è®Šå¦ç‚ºè²ï¼Œæœ¬å¦ç‚ºæ‚”ã€‚",
            5: "ä»¥è®Šå¦ç‚ºè²ï¼Œæœ¬å¦ç‚ºæ‚”ã€‚",
            6: "ä¹¾å¤å¦ç”¨ä¹å…­ï¼Œé¤˜å¦ä»¥è®Šå¦å¦è¾­è§£ã€‚"
        };
        let logic = rules[changeCount] || rules[6];
        let cc = coins.map(n => (n === 6 ? 7 : (n === 9 ? 8 : n)));
        let gn1 = getGua(coins), gn2 = getGua(cc);

        const textToCopy = `ã€ æˆ‘çš„å®šä½å ±å‘Š ã€‘\n` +
                           `å•é¡Œï¼š${q}\n` +
                           `æœ¬å¦ï¼š${gn1} (${coins.join(',')})\n` +
                           `è®Šå¦ï¼š${gn2} (${cc.join(',')})\n` +
                           `è®Šçˆ»æ•¸ï¼š${changeCount}\n` +
                           `å¤§è¡ä¹‹æ•¸ï¼š${sum} (æ¸›æ•¸ï¼š${diff} | ä½è™•ï¼š${dayanPos})\n` +
                           `è§£å¦é‚è¼¯ï¼š${logic}\n` +
                           `ğŸ”® èƒ½é‡å…±æŒ¯ï¼š${kab}\n` +
                           `ğŸ”¥ æ³¨å…¥è‰²èª¿ï¼š${alch}`;

        navigator.clipboard.writeText(textToCopy).then(() => {
            document.getElementById('copy-status').style.display = 'block';
            setTimeout(() => { document.getElementById('copy-status').style.display = 'none'; }, 2000);
        });
    }
</script>
</body>
</html>